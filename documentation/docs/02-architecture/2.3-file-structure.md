# File Structure

## Project Directory Layout

```
tomcad/
├── index.html              # Main application entry point
├── style.css              # Global application styles
├── app.js                 # Application startup script
└── src/                   # Source code directory
    ├── core/              # Core application architecture
    │   ├── BeamViewer.js      # Main orchestrator class
    │   ├── EventBus.js        # Event communication system
    │   ├── EventCoordinator.js # Global event routing
    │   ├── ThreeJSSetup.js    # Three.js initialization
    │   ├── DependencyCheck.js # Module dependency verification
    │   └── core.js            # Base classes and registry
    ├── managers/          # Domain-specific managers
    │   ├── CreationManager.js     # Element creation workflow
    │   ├── SelectionManager.js    # Object selection management
    │   ├── ElementManager.js      # Element CRUD operations
    │   ├── UIManager.js           # UI coordination
    │   ├── GridManager.js         # Parametric grid system
    │   ├── OperationManager.js    # Geometric operations
    │   ├── SnapManager.js         # Geometric snapping
    │   ├── CopyManager.js         # Copy/paste operations
    │   ├── ProfileManager.js      # Steel profile database
    │   └── ConnectionManager.js   # Steel connections
    ├── components/        # Reusable application components
    │   ├── creators/          # Element creation classes
    │   │   ├── BaseCreator.js     # Abstract creator base
    │   │   ├── BeamCreator.js     # Beam element creator
    │   │   ├── ColumnCreator.js   # Column element creator
    │   │   ├── GoalPostCreator.js # Goalpost structure creator
    │   │   └── StairsCreator.js   # Stairs element creator
    │   ├── elements/          # Element data management
    │   │   ├── ElementFactory.js  # Element creation factory
    │   │   ├── ElementModifier.js # Element modification
    │   │   ├── Manager.js         # Element lifecycle
    │   │   └── MeshBuilder.js     # Three.js mesh generation
    │   └── operations/        # Geometric operations
    │       ├── HoleOperation.js   # Hole cutting operation
    │       ├── SlotOperation.js   # Slot cutting operation
    │       └── RectCutOperation.js # Rectangular cuts
    ├── ui/                # User interface components
    │   ├── panels/            # UI panel implementations
    │   │   ├── CreationPanel.js   # Element creation UI
    │   │   ├── EditPanel.js       # Element editing UI
    │   │   ├── ElementListPanel.js # Element browser
    │   │   ├── GridEditPanel.js   # Grid configuration UI
    │   │   └── ConnectionPanel.js # Connection editing
    │   ├── controls/          # UI control widgets
    │   └── dialogs/           # Modal dialogs
    ├── data/              # Data models and configurations
    │   ├── struktura.js       # Main project data model
    │   ├── profiles.js        # Steel profile definitions
    │   └── profiles/          # Profile data files
    ├── rendering/         # 3D rendering components
    │   ├── CameraControls.js  # Camera manipulation
    │   ├── ViewCube.js        # 3D navigation widget
    │   ├── DragControls.js    # Object dragging
    │   └── ConnectionVisualizer.js # Connection visualization
    ├── utils/             # Shared utility functions
    │   └── GeometryUtils.js   # Geometric calculations
    └── export/            # Import/export functionality
        ├── ImportExport.js    # Main import/export manager
        ├── IfcGenerator.js    # IFC file generation
        └── IfcProjectBuilder.js # IFC project structure
```

## File Loading Dependencies

### Critical Loading Order

The application uses ES6 modules with a specific loading order defined in `index.html`:

```html
<!-- 1. Core Data Models -->
<script type="module" src="src/data/struktura.js"></script>
<script type="module" src="src/data/profiles.js"></script>

<!-- 2. Core Architecture -->
<script type="module" src="src/core/EventBus.js"></script>
<script type="module" src="src/core/core.js"></script>

<!-- 3. Utilities -->
<script type="module" src="src/utils/GeometryUtils.js"></script>

<!-- 4. Managers (order matters) -->
<script type="module" src="src/managers/ElementManager.js"></script>
<script type="module" src="src/managers/CreationManager.js"></script>
<script type="module" src="src/managers/SelectionManager.js"></script>

<!-- 5. Components -->
<script type="module" src="src/components/creators/BaseCreator.js"></script>
<script type="module" src="src/components/creators/BeamCreator.js"></script>

<!-- 6. UI Components -->
<script type="module" src="src/ui/panels/CreationPanel.js"></script>

<!-- 7. Main Application -->
<script type="module" src="src/core/BeamViewer.js"></script>
```

## Core File Descriptions

### Application Entry Points

| File | Purpose | Dependencies |
|------|---------|-------------|
| `index.html` | Main application entry, defines loading order | All modules |
| `app.js` | Application startup script | BeamViewer |
| `style.css` | Global CSS styles | None |

### Core Architecture (`src/core/`)

| File | Purpose | Key Classes |
|------|---------|-------------|
| `BeamViewer.js` | Main application orchestrator | BeamViewer |
| `EventBus.js` | Inter-module communication | EventBus |
| `core.js` | Base classes and component registry | BaseComponent, ComponentRegistry |
| `EventCoordinator.js` | Global event routing | EventCoordinator |
| `ThreeJSSetup.js` | Three.js scene initialization | ThreeJSSetup |

### Manager Layer (`src/managers/`)

| File | Domain | Primary Responsibilities |
|------|--------|------------------------|
| `CreationManager.js` | Element Creation | Creator lifecycle, UI coordination |
| `SelectionManager.js` | Object Selection | Selection state, highlighting |
| `ElementManager.js` | Data Operations | CRUD operations, data consistency |
| `UIManager.js` | User Interface | Panel management, UI state |
| `GridManager.js` | Parametric Grids | Grid management, relationships |
| `OperationManager.js` | Geometric Operations | Holes, cuts, modifications |

### Component Layer (`src/components/`)

#### Creators (`src/components/creators/`)
| File | Element Type | Creation Steps |
|------|-------------|----------------|
| `BaseCreator.js` | Abstract Base | Creator interface definition |
| `BeamCreator.js` | Structural Beams | Start point → End point → Profile |
| `ColumnCreator.js` | Structural Columns | Position → Height → Profile |
| `GoalPostCreator.js` | Portal Frames | Multi-step goalpost creation |
| `StairsCreator.js` | Steel Stairs | Complex stair geometry generation |

#### Elements (`src/components/elements/`)
| File | Purpose | Key Functions |
|------|---------|---------------|
| `ElementFactory.js` | Element Creation | `createElement()`, ID generation |
| `ElementModifier.js` | Element Updates | `updateElement()`, `deleteElement()` |
| `MeshBuilder.js` | 3D Visualization | Three.js mesh generation |
| `Manager.js` | Element Lifecycle | Element state management |

### Data Layer (`src/data/`)

| File | Content | Structure |
|------|---------|-----------|
| `struktura.js` | Project data model | Elements, operations, grids, metadata |
| `profiles.js` | Steel profile database | HEA, IPE, RHS, CHS profile definitions |
| `profiles/` | Profile data files | Individual profile specifications |

### UI Layer (`src/ui/`)

| File | Purpose | Manages |
|------|---------|---------|
| `panels/CreationPanel.js` | Element creation UI | Creator parameter input |
| `panels/EditPanel.js` | Element editing UI | Property modification |
| `panels/ElementListPanel.js` | Project browser | Element hierarchy display |
| `panels/GridEditPanel.js` | Grid configuration | Grid parameters and settings |

## File Naming Conventions

### Class Files
- **PascalCase**: `BeamCreator.js`, `ElementManager.js`
- **Descriptive**: Names clearly indicate purpose
- **Suffix Patterns**: `*Creator.js`, `*Manager.js`, `*Panel.js`

### Data Files
- **Lowercase**: `struktura.js`, `profiles.js`
- **Descriptive**: Clear data content indication

### Directory Structure
- **Plural Names**: `managers/`, `creators/`, `panels/`
- **Domain Grouping**: Related functionality grouped together
- **Shallow Hierarchy**: Maximum 3 levels deep

## Module Dependencies

### No Circular Dependencies
- Strict dependency hierarchy enforced
- Base classes loaded before derived classes
- Managers loaded before UI components

### Global Objects
- `strukturaData`: Central project data
- `profilesData`: Steel profile database
- `beamObjects`: Three.js mesh storage
- `EventBus`: Global communication

### Import Patterns
```javascript
// ES6 module imports
import { BaseCreator } from './BaseCreator.js';
import { GeometryUtils } from '../utils/GeometryUtils.js';

// Global object access
const element = strukturaData.elements.find(e => e.id === elementId);
```

## File Organization Principles

### Single Responsibility
- Each file has one primary purpose
- Clear separation of concerns
- Minimal file interdependencies

### Domain Segregation
- Related functionality grouped in directories
- Clear boundaries between application layers
- Consistent naming across similar files

### Extensibility Support
- Easy addition of new creators in `creators/` directory
- New managers follow established patterns
- Plugin architecture preparation in directory structure

This file structure supports TomCAD's goal of simplicity while maintaining professional organization suitable for team development and future expansion.